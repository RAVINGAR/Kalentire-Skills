plugins {
    id 'java-library'
}

dependencies {
    implementation "com.herocraftonline.heroes:Heroes:1.9.17-SNAPSHOT"
    implementation 'org.jetbrains:annotations:20.1.0'
    compileOnly "org.spigotmc:spigot-api:1.17.1-R0.1-SNAPSHOT"
    compileOnly "net.milkbowl.vault:VaultAPI:1.7"
    compileOnly "com.sk89q.worldguard:worldguard-bukkit:7.0.3"
    compileOnly "com.comphenix.protocol:ProtocolLib:4.7.0"
    compileOnly "LibsDisguises:LibsDisguises:10.0.26"
    compileOnly "com.griefcraft.lwc:LWC:4.4.0"
    compileOnly "de.slikey:EffectLib:6.1"
    compileOnly "com.herocraftonline:townships:1.0.0-SNAPSHOT"
    compileOnly "fr.neatmonster:nocheatplus:3.16.1-SNAPSHOT"
    compileOnly "com.github.Xezard:XGlow:1.0.5"
}

allprojects {
    apply plugin: 'java-library'
    apply plugin: 'idea'

    group 'com.herocraftonline.heroes.characters.skill'

    ext {
        hcRepoUsername = System.getenv("HC_REPO_USERNAME") ?: hcRepoUsername
        hcRepoPassword = System.getenv("HC_REPO_PASSWORD") ?: hcRepoPassword
    }
}

repositories {
    gradlePluginPortal()
    mavenLocal()
    mavenCentral()
    maven {
        name 'Bungee Chat Repo'
        url 'https://oss.sonatype.org/content/groups/public/'
    }
    maven {
        name 'worldguard'
        url 'https://maven.enginehub.org/repo/'
    }
    maven {
        name 'herocraft-repo'
        url 'https://nexus.hc.to/content/repositories/herocraft/'
        credentials {
            username hcRepoUsername
            password hcRepoPassword
        }
    }
}

sourceSets {
    main {
        java {
            exclude 'src/main/java/com/herocraftonline/heroes/characters/skill/unusedskills/**'
        }
    }
    bin {
        java {
            srcDir "$projectDir/bin"
        }
    }
    public1 {
        java {
            srcDirs = ["$projectDir/bin/$group/public1"]
        }
    }
}

compileJava {
    sourceCompatibility = 11
    targetCompatibility = 11

    doFirst {
        file(new File(projectDir, "bin").mkdirs())
        file(new File(projectDir, "generated").mkdirs())
    }
}

task compilePacks (type: JavaCompile) {
    source = sourceSets.main.java.srcDirs
    classpath = sourceSets.main.compileClasspath
    destinationDirectory = new File("${projectDir}/bin")
    options.sourcepath = sourceSets.main.java.getSourceDirectories()
}

List<String> packs = ['public1', 'remastered'] as String[]

task jarPacks(type: Jar, dependsOn: compilePacks) {
    destinationDirectory = new File("${projectDir}/generated")
}
