plugins {
    id 'java-library'
}

dependencies {
    implementation "com.herocraftonline.heroes:Heroes:1.9.17-SNAPSHOT"
    compileOnly "org.spigotmc:spigot-api:1.17.1-R0.1-SNAPSHOT"
    compileOnly "net.milkbowl.vault:VaultAPI:1.7"
    compileOnly "com.sk89q.worldguard:worldguard-bukkit:7.0.3"
    compileOnly "mc.alk.tracker:BattleTracker:2.5.5.1"
    compileOnly "com.comphenix.protocol:ProtocolLib:4.7.0"
    compileOnly "LibsDisguises:LibsDisguises:10.0.26"
    compileOnly "io.lumine.xikage:MythicMobs:4.11.2"
    compileOnly "com.griefcraft.lwc:LWC:4.4.0"
    compileOnly "com.bekvon.bukkit.residence:Residence:2.6.6.5"
    compileOnly "de.slikey:EffectLib:6.1"
    compileOnly "com.herocraftonline:townships:1.0.0-SNAPSHOT"
    compileOnly "fr.neatmonster:nocheatplus:3.16.1-SNAPSHOT"
    compileOnly "com.github.Xezard:XGlow:1.0.5"
}

sourceSets {
    bin {
        java {
            srcDir "$projectDir/bin/src"
        }
    }
}

allprojects {
    apply plugin: 'java-library'
    apply plugin: 'idea'

    group 'com.herocraftonline.heroes.characters.skill'

    ext {
        hcRepoUsername = System.getenv("HC_REPO_USERNAME") ?: hcRepoUsername
        hcRepoPassword = System.getenv("HC_REPO_PASSWORD") ?: hcRepoPassword
    }
}

repositories {
    gradlePluginPortal()
    mavenLocal()
    mavenCentral()
    maven {
        name 'Bungee Chat Repo'
        url 'https://oss.sonatype.org/content/groups/public/'
    }
    maven {
        name 'worldguard'
        url 'https://maven.enginehub.org/repo/'
    }
    maven {
        name 'herocraft-repo'
        url 'https://nexus.hc.to/content/repositories/herocraft/'
        credentials {
            username hcRepoUsername
            password hcRepoPassword
        }
    }
}

compileJava {
    sourceCompatibility = 11
    targetCompatibility = 11
    options.compilerArgs = ["-sourcepath", "$projectDir/src"]

    doFirst {
        file(new File(projectDir, "bin/src")).mkdirs()
    }
}

clean.doLast {
    file(new File(projectDir, "bin")).delete()
}

tasks.register("package", JavaCompile) {
    source = sourceSets.main
    classpath = sourceSets.main.compileClasspath
    destinationDirectory = new File("${projectDir}/bin")
}